{% extends 'mediatheque/base.html' %}

{% block title %}Liste des Médias - Médiathèque{% endblock %}

{% block content %}
<div class="container">
    <h2>Liste des Médias</h2>

    <h3 style="margin-top: 1.5rem;">Livres</h3>
    {% if livres %}
    <table style="width: 100%; border-collapse: collapse; margin-bottom: 1rem;">
        <thead>
            <tr style="background: #f0f0f0;">
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Titre</th>
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Auteur</th>
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Disponibles</th>
                {% if user.is_staff and not acces_membre %}
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Actions</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for livre in livres %}
            <tr>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">{{ livre.titre }}</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">{{ livre.auteur }}</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">
                    {% if livre.est_disponible %}
                        <span style="color: green;">{{ livre.exemplaires_disponibles }}/{{ livre.nombre_exemplaires }}</span>
                    {% else %}
                        <span style="color: red;">0/{{ livre.nombre_exemplaires }}</span>
                    {% endif %}
                </td>
                {% if user.is_staff and not acces_membre %}
                <td style="padding: 0.5rem; border: 1px solid #ddd;">
                    {% if livre.est_disponible %}
                    <a href="{% url 'creer_emprunt_livre' livre.pk %}" class="btn btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.9rem;">Emprunter</a>
                    {% endif %}
                    <a href="{% url 'modifier_livre' livre.pk %}" class="btn btn-primary" style="padding: 0.25rem 0.5rem; font-size: 0.9rem;">Modifier</a>
                    <a href="{% url 'supprimer_livre' livre.pk %}" class="btn btn-danger" style="padding: 0.25rem 0.5rem; font-size: 0.9rem;">Supprimer</a>
                </td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>Aucun livre disponible.</p>
    {% endif %}

    <h3 style="margin-top: 1.5rem;">DVDs</h3>
    {% if dvds %}
    <table style="width: 100%; border-collapse: collapse; margin-bottom: 1rem;">
        <thead>
            <tr style="background: #f0f0f0;">
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Titre</th>
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Auteur</th>
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Durée</th>
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Disponibles</th>
                {% if user.is_staff and not acces_membre %}
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Actions</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for dvd in dvds %}
            <tr>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">{{ dvd.titre }}</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">{{ dvd.auteur }}</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">{{ dvd.duree }} min</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">
                    {% if dvd.est_disponible %}
                        <span style="color: green;">{{ dvd.exemplaires_disponibles }}/{{ dvd.nombre_exemplaires }}</span>
                    {% else %}
                        <span style="color: red;">0/{{ dvd.nombre_exemplaires }}</span>
                    {% endif %}
                </td>
                {% if user.is_staff and not acces_membre %}
                <td style="padding: 0.5rem; border: 1px solid #ddd;">
                    {% if dvd.est_disponible %}
                    <a href="{% url 'creer_emprunt_dvd' dvd.pk %}" class="btn btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.9rem;">Emprunter</a>
                    {% endif %}
                    <a href="{% url 'modifier_dvd' dvd.pk %}" class="btn btn-primary" style="padding: 0.25rem 0.5rem; font-size: 0.9rem;">Modifier</a>
                    <a href="{% url 'supprimer_dvd' dvd.pk %}" class="btn btn-danger" style="padding: 0.25rem 0.5rem; font-size: 0.9rem;">Supprimer</a>
                </td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>Aucun DVD disponible.</p>
    {% endif %}

    <h3 style="margin-top: 1.5rem;">CDs</h3>
    {% if cds %}
    <table style="width: 100%; border-collapse: collapse; margin-bottom: 1rem;">
        <thead>
            <tr style="background: #f0f0f0;">
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Titre</th>
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Artiste</th>
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Pistes</th>
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Disponibles</th>
                {% if user.is_staff and not acces_membre %}
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Actions</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for cd in cds %}
            <tr>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">{{ cd.titre }}</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">{{ cd.artiste }}</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">{{ cd.nombre_pistes }}</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">
                    {% if cd.est_disponible %}
                        <span style="color: green;">{{ cd.exemplaires_disponibles }}/{{ cd.nombre_exemplaires }}</span>
                    {% else %}
                        <span style="color: red;">0/{{ cd.nombre_exemplaires }}</span>
                    {% endif %}
                </td>
                {% if user.is_staff and not acces_membre %}
                <td style="padding: 0.5rem; border: 1px solid #ddd;">
                    {% if cd.est_disponible %}
                    <a href="{% url 'creer_emprunt_cd' cd.pk %}" class="btn btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.9rem;">Emprunter</a>
                    {% endif %}
                    <a href="{% url 'modifier_cd' cd.pk %}" class="btn btn-primary" style="padding: 0.25rem 0.5rem; font-size: 0.9rem;">Modifier</a>
                    <a href="{% url 'supprimer_cd' cd.pk %}" class="btn btn-danger" style="padding: 0.25rem 0.5rem; font-size: 0.9rem;">Supprimer</a>
                </td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>Aucun CD disponible.</p>
    {% endif %}

    <h3 style="margin-top: 1.5rem;">Jeux de Plateau (consultation uniquement)</h3>
    {% if jeux %}
    <table style="width: 100%; border-collapse: collapse; margin-bottom: 1rem;">
        <thead>
            <tr style="background: #f0f0f0;">
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Titre</th>
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Éditeur</th>
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Joueurs</th>
                {% if user.is_staff and not acces_membre %}
                <th style="padding: 0.5rem; border: 1px solid #ddd;">Actions</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for jeu in jeux %}
            <tr>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">{{ jeu.titre }}</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">{{ jeu.editeur }}</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">{{ jeu.nombre_joueurs_min }}-{{ jeu.nombre_joueurs_max }}</td>
                {% if user.is_staff and not acces_membre %}
                <td style="padding: 0.5rem; border: 1px solid #ddd;">
                    <a href="{% url 'modifier_jeu' jeu.pk %}" class="btn btn-primary" style="padding: 0.25rem 0.5rem; font-size: 0.9rem;">Modifier</a>
                    <a href="{% url 'supprimer_jeu' jeu.pk %}" class="btn btn-danger" style="padding: 0.25rem 0.5rem; font-size: 0.9rem;">Supprimer</a>
                </td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>Aucun jeu de plateau disponible.</p>
    {% endif %}

    <div style="margin-top: 2rem;">
        {% if user.is_staff and not acces_membre %}
            <a href="{% url 'espace_bibliothecaire' %}" class="btn btn-secondary">Retour</a>
        {% else %}
            <a href="{% url 'home' %}" class="btn btn-secondary">Retour</a>
        {% endif %}
    </div>
</div>
{% endblock %}
